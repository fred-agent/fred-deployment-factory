{
  "settings": {
    "index": {
      "knn": true,
      "number_of_shards": 1,
      "number_of_replicas": 0
    }
  },
  "mappings": {
    "dynamic": false,
    "properties": {
      "text": {
        "type": "text",
        "fields": {
          "keyword": { "type": "keyword", "ignore_above": 256 }
        }
      },

      "vector_field": {
        "type": "knn_vector",
        "dimension": 3072,
        "method": {
          "name": "hnsw",
          "engine": "lucene",
          "space_type": "cosinesimil",
          "parameters": {
            "ef_construction": 512,
            "m": 16
          }
        }
      },

      "metadata": {
        "type": "object",
        "dynamic": false,
        "properties": {
            "session_id": { "type": "keyword" },
            "user_id":    { "type": "keyword" },
          "scope":      { "type": "keyword" },

          "document_uid":   { "type": "keyword" },
          "document_name":  { 
            "type": "text",
            "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
          },

          "title":          { 
            "type": "text",
            "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
          },
          "author":         { 
            "type": "text",
            "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
          },

          "created":        { "type": "date" },
          "modified":       { "type": "date" },
          "last_modified_by": { "type": "keyword" },

          "repository":       { "type": "keyword" },
          "pull_location":    { "type": "keyword" },
          "repository_web":   { "type": "keyword" },
          "repo_ref":         { "type": "keyword" },
          "file_path":        { "type": "keyword" },

          "date_added_to_kb": { "type": "date" },

          "type":            { "type": "keyword" },
          "mime_type":       { "type": "keyword" },
          "file_size_bytes": { "type": "long" },
          "page_count":      { "type": "long" },
          "row_count":       { "type": "long" },

          "sha256":          { "type": "keyword" },
          "language":        { "type": "keyword" },

          "tag_ids":         { "type": "keyword" },

          "license":         { "type": "keyword" },
          "confidential":    { "type": "boolean" },
          "retrievable":     { "type": "boolean" },
          "acl":             { "type": "keyword" },

          "chunk_index":         { "type": "long" },
          "chunk_uid":           { "type": "keyword" },
          "char_start":          { "type": "long" },
          "char_end":            { "type": "long" },

          "heading_slug":        { "type": "keyword" },
          "viewer_fragment":     { "type": "keyword" },
          "original_doc_length": { "type": "long" },

          "section": {
            "type": "text",
            "fields": { "keyword": { "type": "keyword", "ignore_above": 256 } }
          }
        }
      }
    }
  }
}
